<odoo>
	<data>
			<record id="view_article_par_les_entrepreneurs" model="ir.ui.view">
            <field name="name">Prise en charge</field>
            <field name="model">stock.picking</field>
            <field name="mode">primary</field>
            <field name="inherit_id" ref="stock_heri.view_picking_form_advanced"/>
            <field name="arch" type="xml">
                <field name="partner_id" position="replace">
				    <field name="partner_id" />
				</field>
				<xpath expr="//button[@name='do_print_picking']" position="attributes">
		    		<attribute name="states"></attribute>
		    		<attribute name="attrs">{'invisible': [('mouvement_type','in',('bs','be','bci','br','distribution_vers_kiosque','prise_en_charge'))]}</attribute>
	    		</xpath>
                <field name="state" position="replace">
				    <field name="state" widget="statusbar" statusbar_visible="draft,attente_logistique,attente_magasinier,done" />
				</field>
				<xpath expr="//button[@name='do_stock_transfer']" position="attributes">
					<attribute name="groups">purchase_heri.group_magasinier_heri</attribute>
					<attribute name="invisible">1</attribute>
				</xpath>
				<xpath expr="//field[@name='min_date']" position="after">
					<field name="mouvement_type" invisible="1"/>
					<field name="purchase_terminated" invisible="1" />
				</xpath>
				<xpath expr="//field[@name='location_id']" position="replace">
					<field name="location_id" attrs="{'readonly': [('mouvement_type','in',('bs'))]}" string="Magasin d'Origine"/>
				</xpath>
				<xpath expr="//button[@name='action_cancel']" position="attributes">
					<attribute name="attrs">{'invisible': [('state','in',('done','attente_logistique'))]}</attribute>
					<attribute name="groups">purchase_heri.group_logistique_heri</attribute>
				</xpath>
 				<xpath expr="//button[@name='%(stock.act_stock_return_picking)d']" position="attributes">
		    		<attribute name="invisible">1</attribute>
	    		</xpath>
	    		<xpath expr="//field[@name='state']" position="before">
					<button 
				      	    string="Envoyer au logistique" 
				      	    name="action_aviser_logistique"
				      	    class="oe_highlight" 
				      	    attrs="{'invisible': ['|',('state', 'not in', ('draft')), ('mouvement_type','!=','prise_en_charge')]}"
				      	    type="object"
				      	    groups="purchase_heri.group_call_center_heri"
				      	 />
				    <button 
				      	    string="Achat prestataire" 
				      	    name="achat_prestataire"
				      	    class="oe_highlight" 
				      	    attrs="{'invisible': ['|',('state', 'not in', ('attente_logistique')), ('mouvement_type','!=','prise_en_charge')]}"
				      	    type="object"
				      	    groups="purchase_heri.group_logistique_heri"
				      	 />
				     <button 
				      	    string="Envoyer au Magasinier" 
				      	    name="envoye_missionnaire"
				      	    class="oe_highlight" 
				      	    attrs="{'invisible': ['|',('state', 'not in', ('attente_logistique')),('mouvement_type','!=','prise_en_charge')]}"
				      	    type="object"
				      	    groups="purchase_heri.group_logistique_heri"
				      	 />
				      <button 
				      	    string="Transferer l'article" 
				      	    name="do_new_transfer"
				      	    class="oe_highlight" 
				      	    attrs="{'invisible': ['|',('state', 'not in', ('attente_magasinier')),('mouvement_type','!=','prise_en_charge')]}"
				      	    type="object"
				      	    groups="purchase_heri.group_magasinier_heri"
				      	 />
			     </xpath>
			     <xpath expr="//div[@name='button_box']/button[@name='action_see_move_scrap']" position="after">
                        <button 
                        	name="achat_prestataire"
                        	type="object"
                            class="oe_stat_button"
                            icon="fa-truck"
                            attrs="{'invisible': ['|',('mouvement_type','!=','prise_en_charge'),('prestataire_count','=',0)]}"
                            >
                            <field name="prestataire_count"  widget="statinfo" string="Prestataire" help="Prestataire de service"/>
  
                      	</button>
 				</xpath>
            </field>
        </record>
        <!-- action bci et bs lie budget request stock facturation pertes -->
		<record model="ir.actions.act_window" id="action_prise_en_charge_kiosque">
	       	<field name="name">Prise en charge des articles</field>
	       	<field name="res_model">stock.picking</field>
	       	<field name="domain">[('mouvement_type','=','prise_en_charge')]</field> 
	       	<field name="context">{'default_mouvement_type': 'prise_en_charge'}</field>
	       	<field name="view_type">form</field>
	       	<field name="view_mode">tree,form</field>
	   	</record> 
	   	
	   	<record id="action_prise_en_charge_tree" model="ir.actions.act_window.view">
            <field eval="1" name="sequence"/>
            <field name="view_mode">tree</field>
            <field name="view_id" ref="stock.vpicktree"/>
            <field name="act_window_id" ref="action_prise_en_charge_kiosque"/>
        </record>
        <record id="action_prise_en_charge_form" model="ir.actions.act_window.view">
            <field eval="2" name="sequence"/>
            <field name="view_mode">form</field>
            <field name="view_id" ref="view_article_par_les_entrepreneurs"/>
            <field name="act_window_id" ref="action_prise_en_charge_kiosque"/>
		</record>
		<menuitem id="menu_prise_en_charge" name="Prise en charge d'article envoyÃ© par les entrepreneurs" parent="stock_heri.menu_stock_picking_heri" action="action_prise_en_charge_kiosque" sequence="2"/>
	</data>
</odoo>