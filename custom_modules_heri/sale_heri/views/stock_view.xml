<?xml version="1.0" encoding="UTF-8"?>
<odoo>
	<data>
		<!-- Debut bon de sortie facturation form view -->
		<record id="view_bs_stock_form_facturation_tiers_inherit" model="ir.ui.view">
            <field name="name">stock.sortie.facture.form</field>
            <field name="model">stock.picking</field>
            <field name="mode">primary</field>
            <field name="inherit_id" ref="stock_heri.view_picking_form_advanced"/>
            <field name="arch" type="xml">
            	<xpath expr="//form" position="attributes">
                    <attribute name="create">0</attribute>
                </xpath> 
                <field name="state" position="replace">
				    <field name="state" widget="statusbar" statusbar_visible="attente_magasinier,visa_logiste,assigned,done" />
				</field>
				<xpath expr="//button[@name='do_stock_transfer']" position="attributes">
					<attribute name="groups">purchase_heri.group_magasinier_heri</attribute>
					<attribute name="invisible">1</attribute>
				</xpath>
				<xpath expr="//button[@name='action_cancel']" position="attributes">
					<attribute name="attrs">{'invisible': [('state','in',('done','visa_logiste'))]}</attribute>
					<attribute name="groups">purchase_heri.group_logistique_heri</attribute>
				</xpath>
				<xpath expr="//header" position="inside">		
				    <button name="aviser_logistique" string="Pour visa" class="oe_highlight" attrs="{'invisible': ['|',('state','not in',('attente_magasinier')),('mouvement_type','not in',('bs'))]}" groups="purchase_heri.group_magasinier_heri" type="object"/>
				    <button name="action_aviser_magasinier_bs" string="Vu" class="oe_highlight" attrs="{'invisible': ['|',('state','not in',('visa_logiste')), ('mouvement_type','not in',('bs'))]}" groups="purchase_heri.group_logistique_heri" type="object"/>
				</xpath>
            </field>
        </record>
        
        <record model="ir.actions.act_window" id="action_bon_de_sortie_lie_facture_tiers">
	       	<field name="name">Bon de sortie en stock lié</field>
	       	<field name="res_model">stock.picking</field>
	       	<field name="domain">['&amp;',('breq_id','=',active_id),'&amp;',('mouvement_type','=','bs'),('state','!=','draft')]</field>  	
	       	<field name="view_type">form</field>
	       	<field name="view_mode">tree,form</field>
	   	</record> 
	   	
	   	<record id="action_bon_sortie_tree_lie_facture_tiers" model="ir.actions.act_window.view">
            <field eval="1" name="sequence"/>
            <field name="view_mode">tree</field>
            <field name="view_id" ref="stock_heri.view_bon_sortie_sans_creer_tree"/>
            <field name="act_window_id" ref="action_bon_de_sortie_lie_facture_tiers"/>
        </record>
        
        <record id="action_bon_sortie_form_lie_facture_tiers" model="ir.actions.act_window.view">
            <field eval="2" name="sequence"/>
            <field name="view_mode">form</field>
            <field name="view_id" ref="view_bs_stock_form_facturation_tiers_inherit"/>
            <field name="act_window_id" ref="action_bon_de_sortie_lie_facture_tiers"/>
		</record>
		
		<!-- Debut bon de cession intern facturation form view -->
		<record id="view_bci_stock_form_facturation_entrepreneurs_inherit" model="ir.ui.view">
            <field name="name">bon.cession.interne.form</field>
            <field name="model">stock.picking</field>
            <field name="mode">primary</field>
            <field name="inherit_id" ref="stock_heri.view_picking_form_advanced"/>
            <field name="arch" type="xml">
            	<xpath expr="//form" position="attributes">
                    <attribute name="create">0</attribute>
                </xpath> 
                <field name="state" position="replace">
				    <field name="state" widget="statusbar" statusbar_visible="attente_magasinier,visa_logiste,assigned,done" />
				</field>
				<xpath expr="//button[@name='do_stock_transfer']" position="attributes">
					<attribute name="groups">purchase_heri.group_magasinier_heri</attribute>
					<attribute name="invisible">1</attribute>
				</xpath>
				<xpath expr="//field[@name='location_id']" position="replace">
					<field name="location_id" string="Magasin d'Origine"/>
				</xpath>
				<xpath expr="//page[1]" position="attributes">
					<attribute name="invisible">1</attribute>
				</xpath>
				<xpath expr="//field[@name='pack_operation_product_ids']" position="attributes">
						<attributes name="invisible">1</attributes>
                </xpath>
				<xpath expr="//button[@name='action_cancel']" position="attributes">
					<attribute name="attrs">{'invisible': [('state','in',('done','visa_logiste'))]}</attribute>
					<attribute name="groups">purchase_heri.group_logistique_heri</attribute>
				</xpath>
				<xpath expr="//header" position="inside">	
					<button name="do_stock_transfer" string="Valider" class="oe_highlight" attrs="{'invisible': [('state','not in',('assigned'))]}" groups="purchase_heri.group_magasinier_heri" type="object"/>	
				    <button name="aviser_logistique" string="Pour visa" class="oe_highlight" attrs="{'invisible': ['|',('state','not in',('attente_magasinier')),('mouvement_type','not in',('bci'))]}" groups="purchase_heri.group_magasinier_heri" type="object"/>
				    <button name="action_aviser_magasinier_bs" string="Vu" class="oe_highlight" attrs="{'invisible': ['|',('state','not in',('visa_logiste')), ('mouvement_type','not in',('bci'))]}" groups="purchase_heri.group_logistique_heri" type="object"/>
				</xpath>
            </field>
        </record>
		<!-- action bci lie budget request stock facturation par heri entrepreneurs -->
		<record model="ir.actions.act_window" id="action_bon_de_cession_lie_facture_entrepreneurs">
	       	<field name="name">Bon de cession interne lié</field>
	       	<field name="res_model">stock.picking</field>
	       	<field name="domain">['&amp;',('breq_id','=',active_id),'&amp;',('mouvement_type','=','bci'),('state','!=','draft')]</field>  	
	       	<field name="view_type">form</field>
	       	<field name="view_mode">tree,form</field>
	   	</record> 
	   	
	   	<record id="action_bon_cession_tree_lie_entrepreneurs" model="ir.actions.act_window.view">
            <field eval="1" name="sequence"/>
            <field name="view_mode">tree</field>
            <field name="view_id" ref="stock_heri.view_bon_sortie_sans_creer_tree"/>
            <field name="act_window_id" ref="action_bon_de_cession_lie_facture_entrepreneurs"/>
        </record>
        
        <record id="action_bon_cession_form_lie_entrepreneurs" model="ir.actions.act_window.view">
            <field eval="2" name="sequence"/>
            <field name="view_mode">form</field>
            <field name="view_id" ref="view_bci_stock_form_facturation_entrepreneurs_inherit"/>
            <field name="act_window_id" ref="action_bon_de_cession_lie_facture_entrepreneurs"/>
		</record>
		<!-- action bci et bs lie budget request stock facturation par entrepreneurs -->
		<record id="view_bci_et_bs_stock_form_facturation_entrepreneurs_inherit" model="ir.ui.view">
            <field name="name">bon.cession.interne.form</field>
            <field name="model">stock.picking</field>
            <field name="mode">primary</field>
            <field name="inherit_id" ref="stock_heri.view_picking_form_advanced"/>
            <field name="arch" type="xml">
            	<xpath expr="//form" position="attributes">
                    <attribute name="create">0</attribute>
                </xpath> 
                <field name="partner_id" position="replace">
				    <field name="partner_id" readonly="1"/>
				</field>
				<field name="partner_id" position="after">
				    <field name="is_duplicata" invisible="1"/>
				</field>
                <field name="state" position="replace">
				    <field name="state" widget="statusbar" statusbar_visible="attente_magasinier,visa_logiste,assigned,done" />
				</field>
				<xpath expr="//button[@name='do_stock_transfer']" position="attributes">
					<attribute name="groups">purchase_heri.group_magasinier_heri</attribute>
					<attribute name="invisible">1</attribute>
				</xpath>
				<xpath expr="//field[@name='min_date']" position="after">
					<field name="is_bs_create" invisible="1"/>
				</xpath>
				<xpath expr="//field[@name='location_id']" position="replace">
					<field name="location_id" attrs="{'readonly': [('mouvement_type','in',('bs'))]}" string="Magasin d'Origine"/>
				</xpath>
				<xpath expr="//button[@name='action_cancel']" position="attributes">
					<attribute name="attrs">{'invisible': [('state','in',('done','visa_logiste'))]}</attribute>
					<attribute name="groups">purchase_heri.group_logistique_heri</attribute>
				</xpath>
				<xpath expr="//div[@name='button_box']/button[@name='action_see_move_scrap']" position="after">
                        <button 
                        	name="action_bon_de_sortie_bci"
                        	type="object"
                            class="oe_stat_button"
                            icon="fa-truck"
                            attrs="{'invisible': ['|',('state','not in','done'),'|',('mouvement_type','not in','bci'),('bs_count','=',0)]}"
                            >
                            <field name="bs_count"  widget="statinfo" string="Bon de sortie" help="Bon de sortie lie"/>
  
                      	</button>
 				</xpath>
 				<xpath expr="//button[@name='%(stock.act_stock_return_picking)d']" position="attributes">
		    		<attribute name="invisible">1</attribute>
	    		</xpath>
				<xpath expr="//header" position="inside">	
					<button name="do_print_BCI" string="Valider et Imprimer" class="oe_highlight" attrs="{'invisible': ['|',('state','not in','assigned'),('mouvement_type','not in','bci')]}" groups="purchase_heri.group_magasinier_heri" type="object"/>	
				    <button name="do_print_bon_de_cession" string="Imprimer" class="oe_highlight" attrs="{'invisible': ['|',('state','not in','done'),('mouvement_type','not in','bci')]}"  type="object"/>	
				    <button name="aviser_logistique" string="Pour visa" class="oe_highlight" attrs="{'invisible': ['|',('state','not in',('attente_magasinier')),('mouvement_type','not in',('bci','bs'))]}" groups="purchase_heri.group_magasinier_heri" type="object"/>
				    <button name="action_aviser_magasinier_bs" string="Vu" class="oe_highlight" attrs="{'invisible': ['|',('state','not in',('visa_logiste')), ('mouvement_type','not in',('bci'))]}" groups="purchase_heri.group_logistique_heri" type="object"/>
					<button name="action_aviser_call_center_bs" string="Vu" class="oe_highlight" attrs="{'invisible': ['|',('state','not in',('visa_logiste')), ('mouvement_type','not in',('bs'))]}" groups="purchase_heri.group_logistique_heri" type="object"/>
					<button name="action_validation_call_center_bs" string="Valider" class="oe_highlight" attrs="{'invisible': ['|',('state','not in',('attente_call_center')), ('mouvement_type','not in',('bs'))]}" groups="purchase_heri.group_call_center_heri" type="object"/>		
					<button name="create_bs_bci" string="Créer Bon de sortie" class="oe_highlight" attrs="{'invisible': ['|',('state','not in',('done')),'|',('mouvement_type','not in','bci'),('is_bs_create','=',True)]}" groups="purchase_heri.group_magasinier_heri" type="object"/>					
				</xpath>
            </field>
        </record>
		<!-- action bci et bs lie budget request stock facturation par entrepreneurs -->
		<record model="ir.actions.act_window" id="action_bon_de_cession_lie_facture_entrepreneurs_1">
	       	<field name="name">Bon de cession interne et bon de sortie lié</field>
	       	<field name="res_model">stock.picking</field>
	       	<field name="domain">[('breq_id','=',active_id)]</field>  	
	       	<field name="view_type">form</field>
	       	<field name="view_mode">tree,form</field>
	   	</record> 
	   	
	   	<record id="action_bon_cession_tree_lie_entrepreneurs_1" model="ir.actions.act_window.view">
            <field eval="1" name="sequence"/>
            <field name="view_mode">tree</field>
            <field name="view_id" ref="stock_heri.view_bon_sortie_sans_creer_tree"/>
            <field name="act_window_id" ref="action_bon_de_cession_lie_facture_entrepreneurs_1"/>
        </record>
        
        <record id="action_bon_cession_form_lie_entrepreneurs_1" model="ir.actions.act_window.view">
            <field eval="2" name="sequence"/>
            <field name="view_mode">form</field>
            <field name="view_id" ref="view_bci_et_bs_stock_form_facturation_entrepreneurs_inherit"/>
            <field name="act_window_id" ref="action_bon_de_cession_lie_facture_entrepreneurs_1"/>
		</record>
		
		<!-- action bs lie bci stock facturation par entrepreneurs -->
		<record model="ir.actions.act_window" id="action_bon_de_sortie">
	       	<field name="name"> bon de sortie lié</field>
	       	<field name="res_model">stock.picking</field>
	       	<field name="domain">[('picking_bs_id','=',active_id)]</field>  	
	       	<field name="view_type">form</field>
	       	<field name="view_mode">tree,form</field>
	   	</record> 
	   	
	   	<record id="action_bon_sortie_tree" model="ir.actions.act_window.view">
            <field eval="1" name="sequence"/>
            <field name="view_mode">tree</field>
            <field name="view_id" ref="stock_heri.view_bon_sortie_sans_creer_tree"/>
            <field name="act_window_id" ref="action_bon_de_sortie"/>
        </record>
        
        <record id="action_bon_sortie_form" model="ir.actions.act_window.view">
            <field eval="2" name="sequence"/>
            <field name="view_mode">form</field>
            <field name="view_id" ref="view_bci_et_bs_stock_form_facturation_entrepreneurs_inherit"/>
            <field name="act_window_id" ref="action_bon_de_sortie"/>
		</record>
		<record id="stock_location_virtual_client" model="stock.location">
            <field name="name">Emplacement virtuel Client</field>
            <field name="location_id" ref="stock.stock_location_locations_virtual"/>
            <field name="usage">internal</field>
            <field name="company_id"></field>
      	</record>
      	<!-- action bci et bs lie budget request stock facturation  pertes de materiels-->
		<record id="view_bci_et_bs_stock_form_facturation_pertes_inherit" model="ir.ui.view">
            <field name="name">bon.cession.interne.form</field>
            <field name="model">stock.picking</field>
            <field name="mode">primary</field>
            <field name="inherit_id" ref="stock_heri.view_picking_form_advanced"/>
            <field name="arch" type="xml">
            	<xpath expr="//form" position="attributes">
                    <attribute name="create">0</attribute>
                </xpath> 
                <field name="partner_id" position="replace">
				    <field name="partner_id" readonly="1"/>
				</field>
                <field name="state" position="replace">
				    <field name="state" widget="statusbar" statusbar_visible="attente_logistique,attente_call_center,done" />
				</field>
				<xpath expr="//button[@name='do_stock_transfer']" position="attributes">
					<attribute name="groups">purchase_heri.group_magasinier_heri</attribute>
					<attribute name="invisible">1</attribute>
				</xpath>
				<xpath expr="//field[@name='min_date']" position="after">
					<field name="is_bs_create" invisible="1"/>
				</xpath>
				<xpath expr="//field[@name='location_id']" position="replace">
					<field name="location_id" attrs="{'readonly': [('mouvement_type','in',('bs'))]}" string="Magasin d'Origine"/>
				</xpath>
				<xpath expr="//button[@name='action_cancel']" position="attributes">
					<attribute name="attrs">{'invisible': [('state','in',('done','attente_logistique'))]}</attribute>
					<attribute name="groups">purchase_heri.group_logistique_heri</attribute>
				</xpath>
				<xpath expr="//div[@name='button_box']/button[@name='action_see_move_scrap']" position="after">
                        <button 
                        	name="action_bon_de_sortie_perte"
                        	type="object"
                            class="oe_stat_button"
                            icon="fa-truck"
                            attrs="{'invisible': ['|',('state','not in','done'),'|',('mouvement_type','not in','bci'),('bs_count','=',0)]}"
                            >
                            <field name="bs_count"  widget="statinfo" string="Bon de sortie" help="Bon de sortie lie"/>
  
                      	</button>
 				</xpath>
 				<xpath expr="//button[@name='%(stock.act_stock_return_picking)d']" position="attributes">
		    		<attribute name="invisible">1</attribute>
	    		</xpath>
				<xpath expr="//header" position="inside">	
					<button name="do_stock_transfer" string="Valider" class="oe_highlight" attrs="{'invisible': ['|',('state','not in','attente_call_center'),('mouvement_type','not in','bci')]}" groups="purchase_heri.group_call_center_heri" type="object"/>	
				    <button name="action_aviser_call_center_bs" string="Pour visa" class="oe_highlight" attrs="{'invisible': ['|',('state','not in',('attente_logistique')),('mouvement_type','not in',('bci','bs'))]}" groups="purchase_heri.group_logistique_heri" type="object"/>
				    <button 
			    	    type="object"  
			    	    name="do_print_BS" 
			    	    string="Valider et imprimer" 
			    	    attrs="{'invisible': ['|',('state','not in',('attente_call_center')),('mouvement_type','!=','bs')]}"
			    	    groups="purchase_heri.group_call_center_heri"/>	
			    	<button name="create_bs_bci_perte" string="Créer Bon de sortie" class="oe_highlight" attrs="{'invisible': ['|',('state','not in',('done')),'|',('mouvement_type','not in','bci'),('is_bs_create','=',True)]}" groups="purchase_heri.group_logistique_heri" type="object"/>
				</xpath>
            </field>
        </record>
        <!-- action bci et bs lie budget request stock facturation pertes -->
		<record model="ir.actions.act_window" id="action_bon_de_cession_lie_facture_perte">
	       	<field name="name">Bon de cession interne et bon de sortie lié</field>
	       	<field name="res_model">stock.picking</field>
	       	<field name="domain">[('breq_id','=',active_id)]</field>  	
	       	<field name="view_type">form</field>
	       	<field name="view_mode">tree,form</field>
	   	</record> 
	   	
	   	<record id="action_bon_cession_tree_lie_perte" model="ir.actions.act_window.view">
            <field eval="1" name="sequence"/>
            <field name="view_mode">tree</field>
            <field name="view_id" ref="stock_heri.view_bon_sortie_sans_creer_tree"/>
            <field name="act_window_id" ref="action_bon_de_cession_lie_facture_perte"/>
        </record>
        
        <record id="action_bon_cession_form_lie_perte" model="ir.actions.act_window.view">
            <field eval="2" name="sequence"/>
            <field name="view_mode">form</field>
            <field name="view_id" ref="view_bci_et_bs_stock_form_facturation_pertes_inherit"/>
            <field name="act_window_id" ref="action_bon_de_cession_lie_facture_perte"/>
		</record>
        <!-- action bs lie bci stock facturation pertes -->
		<record model="ir.actions.act_window" id="action_bon_de_sortie_perte">
	       	<field name="name"> bon de sortie lié</field>
	       	<field name="res_model">stock.picking</field>
	       	<field name="domain">[('picking_bs_id','=',active_id)]</field>  	
	       	<field name="view_type">form</field>
	       	<field name="view_mode">tree,form</field>
	   	</record> 
	   	
	   	<record id="action_bon_sortie_tree_perte" model="ir.actions.act_window.view">
            <field eval="1" name="sequence"/>
            <field name="view_mode">tree</field>
            <field name="view_id" ref="stock_heri.view_bon_sortie_sans_creer_tree"/>
            <field name="act_window_id" ref="action_bon_de_sortie_perte"/>
        </record>
        
        <record id="action_bon_sortie_form_perte" model="ir.actions.act_window.view">
            <field eval="2" name="sequence"/>
            <field name="view_mode">form</field>
            <field name="view_id" ref="view_bci_et_bs_stock_form_facturation_pertes_inherit"/>
            <field name="act_window_id" ref="action_bon_de_sortie_perte"/>
		</record>
	</data>
</odoo>