<?xml version="1.0" encoding="UTF-8"?>
<odoo>

    <template id="external_layout_footer_heri" name='Footer HERI Redevance'>
        <div class="footer">
            <div class="last-page">
                <div class="row">
                    <div class="col-xs-12" style="font-style:italic; font-size:11px; font-family:Garuda;">
                        <u>Tsara ho fantatra:</u><br/>
                        <p style="margin-left:10px; border-bottom:solid black 1px;">
                            1. Ny tsy fandoavana ara-potoana (farafahatarany ny faha 15 ny volana) ny faktiora (Franchise Fee) dia mitarika fandoavana 5 isanjato (5%) amin'ny tsy voaefa izay mipetraka ao amin'ny faktioran'ny vola manaraka.
                        </p>
                    </div>
                </div>

                <div class="row">
                    <div class="col-xs-12" style="font-size:11px;">
                        <table class="table table-bordered" style="table-layout:fixed;">
                            <tr>
                                <td class="text-center" style="width:25%;">LE CLIENT</td>
                                <td class="text-center" style="width:15%;">Direction Commerciale</td>
                                <td class="text-center" style="width:15%;">Direction</td>
                                <td  style="width:45%;" rowspan="3">
                                    KAONTY AFAHANAO MANDOA VOLA <br/>
                                    * BNI: <span t-field="company.bank_bni" /><br/>
                                    * Acces Banque: <span t-field="company.acces_bank" /><br/>
                                    * M VOLA: <span t-field="company.mvola" /><br/>
                                    * Airtel Money: <span t-field="company.airtel_money" /><br/>
                                    * ORANGE MONEY: <span t-field="company.orange_money" />
                                </td>
                            </tr>
                            <tr>
                                <td style="height:50px !important;"/>
                                <td rowspan="2"/>
                                <td rowspan="2"/>
                            </tr>
                            <tr>
                                <td class="text-center"><i>Nom + Signature + Cachet</i></td>
                            </tr>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </template>

    <template id="report_invoice_redevance" name="Facture Redevance">
        <t t-call="report.html_container">
            <t t-foreach="docs" t-as="o">
                <t t-set="company" t-value="res_company"/>
                <t t-call="report.external_layout_header"/>

                <div class="page">
                    <div class="row">
                        <div class='col-xs-6 pull-right'>
                            <p class="text-center" style="font-size:30px;"><b>FACTURE REDEVANCE</b></p>
                            
                            <div class="row">
                                <div class="col-xs-5 text-right">MOIS DE:</div>
                                <div class="col-xs-5 text-center"><span t-if="o.date_invoice"
                                t-esc="'{:%B}'.format(datetime.datetime.strptime(o.date_invoice, '%Y-%m-%d'))" /></div>
                            </div>
                            <div class="row">
                                <div class="col-xs-5 text-right">DATE: </div>
                                <div class="col-xs-5 text-center">
                                    <div style="border:1px solid black;">
                                        <span t-if="o.date_invoice" t-field="o.date_invoice" />
                                        <t t-if="not o.date_invoice">
                                            <br/>
                                        </t>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-xs-5 text-right">Facture N°:</div>
                                <div class="col-xs-5 text-center">
                                    <div style="border:1px solid black;">
                                        <span t-if="o.number" t-field="o.number" />
                                        <t t-if="not o.number">
                                            <br/>
                                        </t>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row mt16 mb16">
                        <div class="col-xs-6">
                            <div style="background-color:#3E3E3E; color:white; font-weight:bold;" class="text-center">VOTRE INTERLOCUTEUR</div>
                            <div class="row">
                                <div class="col-xs-3 text-right">
                                    Tél:<br/>
                                    Email:
                                </div>
                                <div class="col-xs-9">
                                    <span t-field="o.partner_id.phone" /><br/>
                                    <span t-field="o.partner_id.email" />
                                </div>
                            </div>
                            
                            <div style="border:solid #3E3E3E 1px;">
                                <div style="background-color:#3E3E3E; color:white; font-weight:bold;" class="text-center">HISTORIQUE</div>
                                <div style="height:50px;"/>
                            </div>
                        </div>
                        <div class="col-xs-6">
                            <div style="background-color:#3E3E3E; color:white; font-weight:bold;" class="col-xs-12 text-center">KIOSQUE</div>
                            <div class="col-xs-4">Localité</div>
                            <div class="col-xs-8">: TODO</div>
                            <div class="col-xs-4">Entrepreneur</div>
                            <div class="col-xs-8">: <span t-field="o.kiosk_id" /></div>
                            <div class="col-xs-4">Adresse</div>
                            <div class="col-xs-8">: TODO</div>
                            <div class="col-xs-4">Téléphone</div>
                            <div class="col-xs-8">: TODO</div>
                        </div>
                    </div>

                    <t t-set="currency_precision" t-value="res_company.currency_id.decimal_places" />
                    <div class="row">
                        <div class="col-xs-12">
                            <table class="table table-bordered" style="table-layout:fixed;">
                                <thead>
                                    <tr style="background-color:#3E3E3E; color:white;">
                                        <th class="text-center" style="width:12%; border-color:#3E3E3E !important;">Date</th>
                                        <th class="text-center" style="width:38%; border-color:#3E3E3E !important;">Description</th>
                                        <th class="text-center" style="width:10%; border-color:#3E3E3E !important;">Quantité</th>
                                        <th class="text-center" style="width:10%; border-color:#3E3E3E !important;">Jours</th>
                                        <th class="text-center" style="width:15%; border-color:#3E3E3E !important;">PU HT</th>
                                        <th class="text-center" style="width:15%; border-color:#3E3E3E !important;">Total HT</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <t t-foreach="o.invoice_line_ids" t-as="line">
                                        <tr>
                                            <td class="text-center" style="border-color:#3E3E3E !important;"><span t-field="line.date" /></td>
                                            <td style="border-color:#3E3E3E !important;"><span t-field="line.name" /></td>
                                            <td class="text-center" style="border-color:#3E3E3E !important;"><span t-field="line.quantity" /></td>
                                            <td class="text-center" style="border-color:#3E3E3E !important;"><span t-field="line.number_days" /></td>
                                            <td class="text-center" style="border-color:#3E3E3E !important;"><span t-field="line.price_unit" /></td>
                                            <td class="text-center" style="border-color:#3E3E3E !important;"><t t-esc="line.price_subtotal" t-options="{'widget': 'float', 'precision': currency_precision}" /></td>
                                        </tr>
                                    </t>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-xs-8" style="font-weight:bold;">
                            <div class="text-center col-xs-12" style="background-color:#3E3E3E; color:white; border:solid #3E3E3E 1px;">CONDITIONS DE VENTE</div>
                            <div class="col-xs-12" style="border:solid #3E3E3E 1px;">
                                <u>Mode de règlement: </u><span t-field="o.payment_term_id" />
                                <div class="col-xs-12" style="height:80px;">
                                    <div class="col-xs-3 col-xs-offset-3">
                                        <span t-field="o.date_invoice" />
                                    </div>
                                    <div class="col-xs-5 col-xs-offset-1">
                                        <t t-set="amount_paid" t-value="'{:10,.2f}'.format(o.amount_total-o.residual).replace(',', ' ').replace('.', ',')"/>
                                        <span t-esc="amount_paid"/>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-xs-4">
                            <div class="row">
                                <div class="col-xs-7 text-right"><b>TOTAL HT en <span t-field="o.currency_id.symbol" />:</b></div>
                                <div class="col-xs-5 text-center"><t t-esc="o.amount_untaxed" t-options="{'widget': 'float', 'precision': currency_precision}"/></div>
                            </div>
                            <div class="row">
                                <div class="col-xs-7 text-right"><b>TVA en <span t-field="o.currency_id.symbol" />:</b></div>
                                <div class="col-xs-5 text-center"><t t-esc="o.amount_tax" t-options="{'widget': 'float', 'precision': currency_precision}" /></div>
                            </div>
                            <div class="row">
                                <div class="col-xs-7 text-right"><b>TOTAL TTC en <span t-field="o.currency_id.symbol" />:</b></div>
                                <div class="col-xs-5 text-center"><t t-esc="o.amount_total" t-options="{'widget': 'float', 'precision': currency_precision}" /></div>
                            </div>
                            <div class="row">
                                <div class="col-xs-7 text-right"><b>Avance en <span t-field="o.currency_id.symbol" />:</b></div>
                                <div class="col-xs-5 text-center"><t t-esc="amount_paid"/></div>
                            </div>
                            <div class="row">
                                <div class="col-xs-7 text-right"><b>Net à payer en <span t-field="o.currency_id.symbol" />:</b></div>
                                <div class="col-xs-5 text-center"><t t-esc="o.residual" t-options="{'widget': 'float', 'precision': currency_precision}" /></div>
                            </div>
                        </div>
                    </div>

                    <div class="row mb8 mt8">
                        <div class="col-xs-12">
                            <div>Arrêtée la présente facture à la somme de : <b>TODO</b></div>
                        </div>
                    </div>
                    <div class="row mb8">
                        <div class="col-xs-4">
                            <div class="col-xs-12" style="background-color:#3E3E3E">Payable avant le <span t-field="o.date_due" /></div>
                        </div>
                    </div>
                </div>

                <t t-call="sale_advanced_heri.external_layout_footer_heri" />
            </t>
        </t>
    </template>

    <report
        id="action_report_invoice_redevance"
        model="account.invoice"
        report_type="qweb-pdf"
        string="Facture Redevance"
        paperformat="sale_advanced_heri.invoice_redevance_paperformat"
        name="sale_advanced_heri.report_invoice_redevance"
        file="sale_advanced_heri.report_invoice_redevance" />

</odoo>